{"version":3,"file":"translator.min.js","sources":["../src/translator.js"],"sourcesContent":["// Local/xlate/amd/src/translator.js\ndefine(['core/ajax'], function (Ajax) {\n  var autoDetectEnabled = true;\n  var detectedStrings = new Set();\n  var processedElements = new WeakSet();\n\n  /**\n   * Translate a single element when metadata is present.\n   * @param {Element} node DOM node to translate.\n   * @param {Object<string, string>} map Translation map.\n   * @returns {void}\n   */\n  function translateNode(node, map) {\n    if (node.nodeType !== 1) {\n      return;\n    }\n    var key = node.getAttribute && node.getAttribute('data-xlate');\n    if (key && map[key]) {\n      node.textContent = map[key];\n    }\n    ['placeholder', 'title', 'alt', 'aria-label'].forEach(function (attr) {\n      var akey = node.getAttribute && node.getAttribute('data-xlate-' + attr);\n      if (akey && map[akey]) {\n        node.setAttribute(attr, map[akey]);\n      }\n    });\n  }\n\n  /**\n   * Check if element should be ignored for auto-detection\n   * @param {Element} element - Element to check\n   * @returns {boolean} True if should be ignored\n   */\n    function shouldIgnoreElement(element) {\n        var tagName = element.tagName.toLowerCase();\n\n        // Skip script, style, meta tags\n        if (['script', 'style', 'meta', 'link', 'noscript', 'head'].includes(tagName)) {\n            return true;\n        }\n\n        // Skip if marked to ignore\n        if (element.hasAttribute('data-xlate-ignore') ||\n            element.closest('[data-xlate-ignore]')) {\n            return true;\n        }\n\n        // Skip if already has xlate attributes\n        if (element.hasAttribute('data-xlate') ||\n            element.hasAttribute('data-xlate-placeholder') ||\n            element.hasAttribute('data-xlate-title') ||\n            element.hasAttribute('data-xlate-alt')) {\n            return true;\n        }\n\n        // Skip admin paths entirely - these should use Moodle language strings\n        var currentPath = window.location.pathname;\n        var adminPaths = [\n            '/admin/',\n            '/local/xlate/',\n            '/course/modedit.php',\n            '/grade/edit/',\n            '/backup/',\n            '/restore/',\n            '/user/editadvanced.php'\n        ];\n\n        for (var p = 0; p < adminPaths.length; p++) {\n            if (currentPath.includes(adminPaths[p])) {\n                return true;\n            }\n        }\n\n        // Skip admin/navigation elements that shouldn't be translated\n        var adminSelectors = [\n            '.navbar', '.navigation', '.breadcrumb', '.nav',\n            '.admin-menu', '.settings-menu', '.user-menu',\n            '.page-header-headings', '.page-context-header',\n            '.activity-navigation', '.course-content-header',\n            '.block_settings', '.block_navigation',\n            '#page-navbar', '#nav-drawer', '.drawer',\n            '.form-autocomplete-suggestions', '.popover',\n            '.tooltip', '.dropdown-menu'\n        ];\n\n        for (var i = 0; i < adminSelectors.length; i++) {\n            if (element.closest(adminSelectors[i])) {\n                return true;\n            }\n        }\n\n        // Skip if element or parent has admin-related classes\n        var adminClasses = [\n            'editing', 'editor', 'admin-only', 'teacher-only',\n            'form-control', 'btn-secondary', 'btn-outline',\n            'text-muted', 'small', 'sr-only', 'accesshide'\n        ];\n\n        var elementClasses = (element.className || '').split(' ');\n        for (var j = 0; j < adminClasses.length; j++) {\n            if (elementClasses.includes(adminClasses[j])) {\n                return true;\n            }\n        }\n\n        // Skip elements with very short or common admin text\n        var text = element.textContent.trim();\n        if (text.length < 3) {\n            return true;\n        }\n\n        var adminWords = [\n            'edit', 'delete', 'save', 'cancel', 'ok', 'yes', 'no',\n            'settings', 'config', 'admin', 'manage', 'update',\n            'hide', 'show', 'move', 'copy', 'options', 'actions'\n        ];\n\n        var lowerText = text.toLowerCase();\n        if (adminWords.includes(lowerText)) {\n            return true;\n        }\n\n        return false;\n    }  /**\n   * Check if text content is worth translating\n   * @param {string} text - Text to analyze\n   * @returns {boolean} True if should be translated\n   */\n  function isTranslatableText(text) {\n    if (!text || text.length < 3) {\n      return false;\n    }\n\n    // Skip if mostly numbers, symbols, or code\n    var alphaCount = (text.match(/[a-zA-Z]/g) || []).length;\n    if (alphaCount < text.length * 0.5) {\n      return false;\n    }\n\n    // Skip common non-translatable patterns\n    var skipPatterns = [\n      /^\\d+[\\s\\d]*$/, // Just numbers\n      /^[A-Z]{2,}$/, // All caps abbreviations\n      /^[a-z_]+$/, // Variable names\n      /^\\w+\\.\\w+/, // File extensions or dot notation\n      /^https?:/, // URLs\n      /^\\/\\w+/, // Paths\n      /^\\{[^}]+\\}$/, // Template variables\n      /^\\[[^\\]]+\\]$/, // Bracketed content\n      /^<[^>]+>$/ // HTML tags\n    ];\n\n    for (var i = 0; i < skipPatterns.length; i++) {\n      if (skipPatterns[i].test(text.trim())) {\n        return false;\n      }\n    }\n\n    // Skip single common words that don't need translation\n    var commonWords = ['ok', 'id', 'url', 'api', 'css', 'js', 'html', 'php'];\n    if (commonWords.includes(text.toLowerCase().trim())) {\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Extract clean text from element, handling HTML\n   * @param {Element} element - Element to extract text from\n   * @returns {string} Clean text content\n   */\n  function extractCleanText(element) {\n    var text = '';\n\n    // If element has only text nodes and simple formatting\n    if (element.children.length === 0) {\n      text = element.textContent.trim();\n    } else {\n      // Check if element has only simple formatting (b, i, em, strong, span)\n      var simpleFormatting = true;\n      var children = element.children;\n\n      for (var i = 0; i < children.length; i++) {\n        var tagName = children[i].tagName.toLowerCase();\n        if (!['b', 'i', 'em', 'strong', 'span', 'small'].includes(tagName)) {\n          simpleFormatting = false;\n          break;\n        }\n      }\n\n      if (simpleFormatting) {\n        text = element.textContent.trim();\n      }\n    }\n\n    // Clean up the text\n    return text\n      .replace(/\\s+/g, ' ') // Normalize spaces\n      .replace(/^\\s+|\\s+$/g, '') // Trim\n      .replace(/['\"]/g, \"'\"); // Normalize quotes\n  }\n\n  /**\n   * Generate component name from element context\n   * @param {Element} element - Element to analyze\n   * @returns {string} Component name\n   */\n  function detectComponent(element) {\n    // Check for Moodle-specific containers\n    var container = element.closest('[data-region]');\n    if (container) {\n      var region = container.getAttribute('data-region');\n      if (region) {\n        return 'region_' + region;\n      }\n    }\n\n    // Check for block containers\n    container = element.closest('.block');\n    if (container) {\n      var blockClass = container.className.match(/block_(\\w+)/);\n      if (blockClass) {\n        return 'block_' + blockClass[1];\n      }\n    }\n\n    // Check for course module containers\n    container = element.closest('.activity');\n    if (container) {\n      var activityClass = container.className.match(/modtype_(\\w+)/);\n      if (activityClass) {\n        return 'mod_' + activityClass[1];\n      }\n    }\n\n    // Check for admin pages\n    if (document.body.classList.contains('path-admin')) {\n      return 'admin';\n    }\n\n    // Default to core\n    return 'core';\n  }\n\n  /**\n   * Generate translation key from element content and context\n   * @param {Element} element - Element to generate key for\n   * @param {string} text - Text content\n   * @param {string} type - Type of content (text, placeholder, title, alt)\n   * @returns {string} Generated key\n   */\n  function generateKey(element, text, type) {\n    var tagName = element.tagName.toLowerCase();\n    var keyParts = [];\n\n    // Add context based on element type\n    if (type === 'placeholder') {\n      keyParts.push('Input');\n    } else if (['h1', 'h2', 'h3', 'h4', 'h5', 'h6'].includes(tagName)) {\n      keyParts.push('Heading');\n    } else if (tagName === 'button' || (tagName === 'input' && element.type === 'submit')) {\n      keyParts.push('Button');\n    } else if (tagName === 'a') {\n      keyParts.push('Link');\n    } else if (tagName === 'label') {\n      keyParts.push('Label');\n    } else if (type === 'alt') {\n      keyParts.push('Image');\n    } else if (type === 'title') {\n      keyParts.push('Title');\n    }\n\n    // Clean and format text as key part\n    var cleanText = text\n      .replace(/[^\\w\\s]/g, '') // Remove special chars\n      .replace(/\\s+/g, ' ') // Normalize spaces\n      .trim()\n      .split(' ')\n      .map(function (word) {\n        return word.charAt(0).toUpperCase() + word.slice(1).toLowerCase();\n      })\n      .join('');\n\n    if (cleanText) {\n      keyParts.push(cleanText);\n    } else {\n      keyParts.push('Text');\n    }\n\n    // Add type suffix if not text content\n    if (type && type !== 'text') {\n      keyParts.push(type.charAt(0).toUpperCase() + type.slice(1));\n    }\n\n    return keyParts.join('.');\n  }\n\n  /**\n   * Auto-detect and save translatable string\n   * @param {Element} element - Element containing the string\n   * @param {string} text - Text content to save\n   * @param {string} type - Type of content (text, placeholder, title, alt)\n   */\n  function autoDetectString(element, text, type) {\n    if (!autoDetectEnabled || !text || text.length < 2) {\n      return;\n    }\n\n    // Skip if already processed\n    var uniqueId = text + ':' + type + ':' + element.tagName;\n    if (detectedStrings.has(uniqueId)) {\n      return;\n    }\n\n    detectedStrings.add(uniqueId);\n\n    var component = detectComponent(element);\n    var key = generateKey(element, text, type);\n\n    // Save via AJAX\n    Ajax.call([{\n      methodname: 'local_xlate_save_key',\n      args: {\n        component: component,\n        key: key,\n        source: text,\n        lang: M.cfg.language || 'en',\n        translation: text\n      }\n    }])[0].then(function () {\n      // Apply the attribute to the element\n      var attrName = 'data-xlate' + (type !== 'text' ? '-' + type : '');\n      element.setAttribute(attrName, key);\n\n      // Update the global map\n      if (window.__XLATE__ && window.__XLATE__.map) {\n        window.__XLATE__.map[key] = text;\n      }\n\n      return true;\n    }).catch(function () {\n      // Silently fail - don't break the page if auto-detection fails\n      detectedStrings.delete(uniqueId);\n    });\n  }\n\n  /**\n   * Auto-detect translatable content in an element\n   * @param {Element} element - Element to analyze\n   */\n  function autoDetectElement(element) {\n    if (shouldIgnoreElement(element) || processedElements.has(element)) {\n      return;\n    }\n\n    processedElements.add(element);\n\n    // Check text content with smart extraction\n    var textContent = extractCleanText(element);\n    if (textContent && isTranslatableText(textContent)) {\n      autoDetectString(element, textContent, 'text');\n    }\n\n    // Check attributes\n    if (element.hasAttribute('placeholder')) {\n      var placeholder = element.getAttribute('placeholder').trim();\n      if (placeholder && isTranslatableText(placeholder)) {\n        autoDetectString(element, placeholder, 'placeholder');\n      }\n    }\n\n    if (element.hasAttribute('title')) {\n      var title = element.getAttribute('title').trim();\n      if (title && isTranslatableText(title)) {\n        autoDetectString(element, title, 'title');\n      }\n    }\n\n    if (element.hasAttribute('alt')) {\n      var alt = element.getAttribute('alt').trim();\n      if (alt && isTranslatableText(alt)) {\n        autoDetectString(element, alt, 'alt');\n      }\n    }\n  }\n\n  /**\n   * Walk the DOM depth-first and translate every eligible child.\n   * @param {Element} root Root element to process.\n   * @param {Object<string, string>} map Translation map.\n   * @returns {void}\n   */\n  function walk(root, map) {\n    var stack = [root];\n    while (stack.length) {\n      var el = stack.pop();\n      if (el.nodeType === 1) {\n        if (el.hasAttribute && el.hasAttribute('data-xlate-ignore')) {\n          continue;\n        }\n\n        // Translate existing keys\n        translateNode(el, map);\n\n        // Auto-detect new strings if enabled\n        if (autoDetectEnabled) {\n          autoDetectElement(el);\n        }\n\n        var children = el.children || [];\n        for (var i = 0; i < children.length; i++) {\n          stack.push(children[i]);\n        }\n      }\n    }\n  }\n\n  /**\n   * Entry point: translates current DOM and observes future updates.\n   * @param {Object<string, string>} map Translation map.\n   * @returns {void}\n   */\n  function run(map) {\n    try {\n      walk(document.body, map || {});\n\n      // Start auto-detection after initial translation\n      if (autoDetectEnabled) {\n        setTimeout(function () {\n          walk(document.body, map || {});\n        }, 1000); // Delay to let page fully load\n      }\n\n      var mo = new MutationObserver(function (muts) {\n        muts.forEach(function (m) {\n          (m.addedNodes || []).forEach(function (n) {\n            if (n.nodeType === 1) {\n              walk(n, map || {});\n            }\n          });\n        });\n      });\n      mo.observe(document.body, { childList: true, subtree: true });\n    } finally {\n      document.documentElement.classList.remove('xlate-loading');\n    }\n  }\n\n  /**\n   * Initialize the translator with config from Moodle.\n   * @param {Object} config Configuration object with lang, version, bundleurl.\n   * @returns {void}\n   */\n  function init(config) {\n    document.documentElement.classList.add('xlate-loading');\n    var k = 'xlate:' + config.lang + ':' + config.version;\n\n    window.__XLATE__ = { lang: config.lang, map: {} };\n\n    try {\n      var cached = localStorage.getItem(k);\n      if (cached) {\n        var bundle = JSON.parse(cached);\n        window.__XLATE__.map = bundle;\n        run(bundle);\n      }\n\n      fetch(config.bundleurl, { credentials: 'same-origin' })\n        .then(function (r) {\n          return r.json();\n        })\n        .then(function (bundle) {\n          try {\n            localStorage.setItem(k, JSON.stringify(bundle));\n          } catch (e) {\n            // Storage quota exceeded, ignore\n          }\n          if (!cached) {\n            window.__XLATE__.map = bundle;\n            run(bundle);\n          }\n\n          return true;\n        })\n        .catch(function () {\n          if (!cached) {\n            run({});\n          }\n        });\n    } catch (e) {\n      fetch(config.bundleurl)\n        .then(function (r) {\n          return r.json();\n        })\n        .then(function (bundle) {\n          window.__XLATE__.map = bundle;\n          run(bundle);\n\n          return true;\n        })\n        .catch(function () {\n          run({});\n        });\n    }\n  }\n\n  /**\n   * Enable or disable automatic string detection\n   * @param {boolean} enabled - Whether to enable auto-detection\n   */\n  function setAutoDetect(enabled) {\n    autoDetectEnabled = enabled;\n  }\n\n  return {\n    run: run,\n    init: init,\n    setAutoDetect: setAutoDetect\n  };\n});"],"names":["define","Ajax","autoDetectEnabled","detectedStrings","Set","processedElements","WeakSet","translateNode","node","map","nodeType","key","getAttribute","textContent","forEach","attr","akey","setAttribute","isTranslatableText","text","length","match","skipPatterns","i","test","trim","includes","toLowerCase","autoDetectString","element","type","uniqueId","tagName","has","add","component","container","closest","region","blockClass","className","activityClass","document","body","classList","contains","detectComponent","keyParts","push","cleanText","replace","split","word","charAt","toUpperCase","slice","join","generateKey","call","methodname","args","source","lang","M","cfg","language","translation","then","attrName","window","__XLATE__","catch","delete","autoDetectElement","hasAttribute","currentPath","location","pathname","adminPaths","p","adminSelectors","adminClasses","elementClasses","j","lowerText","shouldIgnoreElement","children","simpleFormatting","extractCleanText","placeholder","title","alt","walk","root","stack","el","pop","run","setTimeout","MutationObserver","muts","m","addedNodes","n","observe","childList","subtree","documentElement","remove","init","config","k","version","cached","localStorage","getItem","bundle","JSON","parse","fetch","bundleurl","credentials","r","json","setItem","stringify","e","setAutoDetect","enabled"],"mappings":"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"}