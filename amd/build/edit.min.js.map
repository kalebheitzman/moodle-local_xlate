{"version":3,"file":"edit.min.js","sources":["../src/edit.js"],"sourcesContent":["// AMD module providing an inline translation inspector overlay for captured keys.\n// Displays a dashed highlight plus controls to jump to Manage UI while browsing.\n/* eslint-disable jsdoc/require-jsdoc */\ndefine([], function () {\n    var ATTR_KEY_PREFIX = 'data-xlate-key-';\n    var ATTRIBUTE_TYPES = ['content', 'placeholder', 'title', 'alt', 'aria-label'];\n    var SELECTOR = ATTRIBUTE_TYPES.map(function (attr) {\n        return '[' + ATTR_KEY_PREFIX + attr + ']';\n    }).join(',');\n    var STICKY_PADDING = 24;\n    var STATE = {\n        config: {\n            enabled: false,\n            manageUrl: '',\n            courseid: 0,\n            strings: {},\n            inlineToggle: false\n        },\n        active: false,\n        currentElement: null,\n        currentAttribute: null,\n        attributes: [],\n        ready: false,\n        hasExternalToggle: false,\n        toggleRenderer: null\n    };\n    var NODES = {\n        toggle: null,\n        highlight: null,\n        toolbar: null,\n        callout: null\n    };\n\n    function ready(fn) {\n        if (document.readyState === 'loading') {\n            document.addEventListener('DOMContentLoaded', fn);\n            return;\n        }\n        fn();\n    }\n\n    function init(userConfig) {\n        if (typeof window === 'undefined' || typeof document === 'undefined') {\n            return;\n        }\n        STATE.config = merge(STATE.config, userConfig || {});\n        if (!STATE.config.enabled) {\n            return;\n        }\n        ready(function () {\n            injectStyles();\n            if (!STATE.hasExternalToggle && !STATE.config.inlineToggle) {\n                buildToggle();\n            }\n            STATE.ready = true;\n            updateToggleVisuals();\n        });\n    }\n\n    function merge(base, overrides) {\n        var result = {};\n        var key;\n        for (key in base) {\n            if (Object.prototype.hasOwnProperty.call(base, key)) {\n                if (typeof base[key] === 'object' && base[key] !== null && !Array.isArray(base[key])) {\n                    result[key] = merge(base[key], {});\n                } else {\n                    result[key] = base[key];\n                }\n            }\n        }\n        for (key in overrides) {\n            if (!Object.prototype.hasOwnProperty.call(overrides, key)) {\n                continue;\n            }\n            var val = overrides[key];\n            if (val && typeof val === 'object' && !Array.isArray(val)) {\n                result[key] = merge(result[key] || {}, val);\n            } else {\n                result[key] = val;\n            }\n        }\n        return result;\n    }\n\n    function injectStyles() {\n        if (document.querySelector('style[data-xlate-style=\"inspector\"]')) {\n            return;\n        }\n        var style = document.createElement('style');\n        style.setAttribute('data-xlate-style', 'inspector');\n        style.textContent = '' +\n            '.xlate-inspector-toggle{' +\n            'position:fixed;' +\n            'bottom:1.5rem;' +\n            'right:1.5rem;' +\n            'z-index:2147482000;' +\n            'padding:0.65rem 1.1rem;' +\n            'border-radius:999px;' +\n            'box-shadow:0 10px 30px rgba(13,110,253,.25);' +\n            '}' +\n            '.xlate-inspector-toggle.is-active{' +\n            'background:#0b5ed7;' +\n            '}' +\n            '.xlate-inspector-highlight{' +\n            'position:fixed;' +\n            'border:2px dashed #0d6efd;' +\n            'border-radius:0.75rem;' +\n            'pointer-events:none;' +\n            'z-index:2147481000;' +\n            'box-shadow:0 0 0 2px rgba(13,110,253,.2);' +\n            'display:none;' +\n            '}' +\n            '.xlate-inspector-highlight.is-visible{' +\n            'display:block;' +\n            '}' +\n            '.xlate-inspector-toolbar,' +\n            '.xlate-inspector-callout{' +\n            'position:fixed;' +\n            'z-index:2147481200;' +\n            'background:#0d1117;' +\n            'color:#f0f6ff;' +\n            'border-radius:0.6rem;' +\n            'padding:0.75rem;' +\n            'box-shadow:0 12px 45px rgba(15,23,42,.35);' +\n            'display:none;' +\n            'max-width:420px;' +\n            'font-size:0.875rem;' +\n            '}' +\n            '.xlate-inspector-toolbar{' +\n            'display:flex;' +\n            'flex-wrap:wrap;' +\n            'gap:0.5rem;' +\n            'align-items:center;' +\n            '}' +\n            '.xlate-inspector-toolbar.is-visible,' +\n            '.xlate-inspector-callout.is-visible{' +\n            'display:flex;' +\n            'flex-direction:column;' +\n            '}' +\n            '.xlate-inspector-attributes{' +\n            'display:flex;' +\n            'gap:0.25rem;' +\n            'flex-wrap:wrap;' +\n            '}' +\n            '.xlate-inspector-attr{' +\n            'background:rgba(255,255,255,.08);' +\n            'border:none;' +\n            'color:inherit;' +\n            'padding:0.2rem 0.75rem;' +\n            'border-radius:999px;' +\n            'font-size:0.75rem;' +\n            'cursor:pointer;' +\n            '}' +\n            '.xlate-inspector-attr.is-active{' +\n            'background:#1f6feb;' +\n            '}' +\n            '.xlate-inspector-meta{' +\n            'display:flex;' +\n            'gap:0.4rem;' +\n            'flex-wrap:wrap;' +\n            'align-items:center;' +\n            'margin-top:0.35rem;' +\n            '}' +\n            '.xlate-inspector-key{' +\n            'font-family:monospace;' +\n            'background:rgba(255,255,255,.08);' +\n            'padding:0.1rem 0.4rem;' +\n            'border-radius:0.35rem;' +\n            '}' +\n            '.xlate-inspector-action{' +\n            'background:rgba(255,255,255,.08);' +\n            'border:none;' +\n            'color:inherit;' +\n            'padding:0.35rem 0.75rem;' +\n            'border-radius:0.45rem;' +\n            'font-size:0.75rem;' +\n            'cursor:pointer;' +\n            'text-decoration:none;' +\n            '}' +\n            '.xlate-inspector-action:hover{' +\n            'background:rgba(255,255,255,.18);' +\n            '}' +\n            '.xlate-inspector-callout{' +\n            'font-size:0.85rem;' +\n            'gap:0.35rem;' +\n            '}' +\n            '.xlate-inspector-callout-label{' +\n            'font-weight:600;' +\n            'text-transform:uppercase;' +\n            'letter-spacing:0.04em;' +\n            'font-size:0.7rem;' +\n            'color:#93c5fd;' +\n            '}' +\n            '.xlate-inspector-callout-text{' +\n            'max-height:none;' +\n            'overflow:visible;' +\n            'white-space:pre-wrap;' +\n            '}' +\n            '.xlate-inspector-toast{' +\n            'position:fixed;' +\n            'bottom:4.75rem;' +\n            'right:1.5rem;' +\n            'background:#0d6efd;' +\n            'color:#fff;' +\n            'padding:0.55rem 1rem;' +\n            'border-radius:0.45rem;' +\n            'box-shadow:0 10px 30px rgba(13,110,253,.35);' +\n            'opacity:0;' +\n            'pointer-events:none;' +\n            'transition:opacity .2s ease;' +\n            'z-index:2147483000;' +\n            '}' +\n            '.xlate-inspector-toast.is-visible{' +\n            'opacity:1;' +\n            '}' +\n            '.xlate-inspector-toggle:focus-visible,' +\n            '.xlate-inspector-attr:focus-visible,' +\n            '.xlate-inspector-action:focus-visible{' +\n            'outline:2px solid #facc15;' +\n            'outline-offset:2px;' +\n            '}' +\n            '.xlate-inspector-empty{' +\n            'opacity:0.6;' +\n            '}';\n        document.head.appendChild(style);\n    }\n\n    function buildToggle() {\n        if (STATE.hasExternalToggle || NODES.toggle) {\n            return;\n        }\n        var button = document.createElement('button');\n        button.type = 'button';\n        button.className = 'btn btn-primary xlate-inspector-toggle';\n        button.textContent = STATE.config.strings.toggleInactive || 'Enable inspector';\n        button.setAttribute('aria-pressed', 'false');\n        button.setAttribute('aria-label', STATE.config.strings.toggleLabel || 'Translation inspector');\n        button.title = STATE.config.strings.toggleHint || '';\n        button.setAttribute('data-xlate-inspector-toggle', 'true');\n        attachToggleButton(button);\n        STATE.toggleRenderer = function (active) {\n            var activeText = STATE.config.strings.toggleActive || 'Inspector enabled';\n            var inactiveText = STATE.config.strings.toggleInactive || 'Enable inspector';\n            button.textContent = active ? activeText : inactiveText;\n        };\n        NODES.toggle = button;\n        document.body.appendChild(button);\n        updateToggleVisuals();\n    }\n\n    function attachToggleButton(button) {\n        if (!button) {\n            return;\n        }\n        button.addEventListener('click', handleToggleClick);\n    }\n\n    function detachToggleButton(button) {\n        if (!button) {\n            return;\n        }\n        button.removeEventListener('click', handleToggleClick);\n    }\n\n    function handleToggleClick(event) {\n        event.preventDefault();\n        if (!STATE.ready || !STATE.config.enabled) {\n            return;\n        }\n        if (STATE.active) {\n            deactivateInspector();\n        } else {\n            activateInspector();\n        }\n    }\n\n    function activateInspector() {\n        if (STATE.active) {\n            return;\n        }\n        STATE.active = true;\n        document.addEventListener('pointermove', handlePointerMove, true);\n        document.addEventListener('pointerleave', handlePointerLeave, true);\n        window.addEventListener('scroll', handleViewportChange, true);\n        window.addEventListener('resize', handleViewportChange, true);\n        document.addEventListener('keydown', handleKeydown, true);\n        document.documentElement.classList.add('xlate-inspector-active');\n        updateToggleVisuals();\n        showToast(STATE.config.strings.toggleActive || 'Inspector enabled');\n    }\n\n    function deactivateInspector() {\n        if (!STATE.active) {\n            return;\n        }\n        STATE.active = false;\n        document.removeEventListener('pointermove', handlePointerMove, true);\n        document.removeEventListener('pointerleave', handlePointerLeave, true);\n        window.removeEventListener('scroll', handleViewportChange, true);\n        window.removeEventListener('resize', handleViewportChange, true);\n        document.removeEventListener('keydown', handleKeydown, true);\n        document.documentElement.classList.remove('xlate-inspector-active');\n        updateToggleVisuals();\n        clearCurrent();\n    }\n\n    function updateToggleVisuals() {\n        if (!NODES.toggle) {\n            return;\n        }\n        var button = NODES.toggle;\n        if (STATE.active) {\n            button.classList.add('is-active');\n            button.setAttribute('aria-pressed', 'true');\n        } else {\n            button.classList.remove('is-active');\n            button.setAttribute('aria-pressed', 'false');\n        }\n        if (button.classList) {\n            if (!STATE.ready) {\n                button.classList.add('is-disabled');\n            } else {\n                button.classList.remove('is-disabled');\n            }\n        }\n        if (typeof button.disabled !== 'undefined') {\n            button.disabled = !STATE.ready;\n        }\n        button.setAttribute('aria-disabled', STATE.ready ? 'false' : 'true');\n        if (STATE.toggleRenderer) {\n            STATE.toggleRenderer(STATE.active);\n        } else {\n            var activeText = STATE.config.strings.toggleActive || 'Inspector enabled';\n            var inactiveText = STATE.config.strings.toggleInactive || 'Enable inspector';\n            button.textContent = STATE.active ? activeText : inactiveText;\n        }\n    }\n\n    function handlePointerMove(event) {\n        if (!STATE.active) {\n            return;\n        }\n        if (isOverlayNode(event.target)) {\n            return;\n        }\n        var candidate = event.target.closest ? event.target.closest(SELECTOR) : null;\n        if (!candidate) {\n            if (isWithinStickyZone(event)) {\n                return;\n            }\n            clearCurrent();\n            return;\n        }\n        if (STATE.currentElement === candidate) {\n            return;\n        }\n        setCurrentElement(candidate);\n    }\n\n    function handlePointerLeave(event) {\n        if (!STATE.active) {\n            return;\n        }\n        if (isOverlayNode(event.relatedTarget)) {\n            return;\n        }\n        if (!event.relatedTarget) {\n            clearCurrent();\n        }\n    }\n\n    function handleViewportChange() {\n        if (!STATE.active || !STATE.currentElement) {\n            return;\n        }\n        refreshOverlay();\n    }\n\n    function handleKeydown(event) {\n        if (!STATE.active) {\n            return;\n        }\n        if (event.key === 'Escape' || event.key === 'Esc') {\n            event.preventDefault();\n            deactivateInspector();\n        }\n    }\n\n    function isOverlayNode(node) {\n        if (!node) {\n            return false;\n        }\n        if (node === NODES.toolbar || node === NODES.callout) {\n            return true;\n        }\n        if (!node.closest) {\n            return false;\n        }\n        return !!(\n            node.closest('.xlate-inspector-toolbar') ||\n            node.closest('.xlate-inspector-callout')\n        );\n    }\n\n    function isWithinStickyZone(event) {\n        if (!STATE.currentElement) {\n            return false;\n        }\n        if (typeof event.clientX !== 'number' || typeof event.clientY !== 'number') {\n            return false;\n        }\n        var rect = STATE.currentElement.getBoundingClientRect();\n        if (!rect) {\n            return false;\n        }\n        var x = event.clientX;\n        var y = event.clientY;\n        return x >= rect.left - STICKY_PADDING &&\n            x <= rect.right + STICKY_PADDING &&\n            y >= rect.top - STICKY_PADDING &&\n            y <= rect.bottom + STICKY_PADDING;\n    }\n\n    function setCurrentElement(element) {\n        STATE.currentElement = element;\n        STATE.attributes = collectAttributes(element);\n        if (!STATE.attributes.length) {\n            clearCurrent();\n            return;\n        }\n        if (!STATE.currentAttribute) {\n            STATE.currentAttribute = STATE.attributes[0].type;\n        }\n        if (!attributeExists(STATE.currentAttribute)) {\n            STATE.currentAttribute = STATE.attributes[0].type;\n        }\n        refreshOverlay();\n    }\n\n    function attributeExists(type) {\n        for (var i = 0; i < STATE.attributes.length; i++) {\n            if (STATE.attributes[i].type === type) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    function collectAttributes(element) {\n        var attrs = [];\n        for (var i = 0; i < ATTRIBUTE_TYPES.length; i++) {\n            var attrType = ATTRIBUTE_TYPES[i];\n            var keyAttr = ATTR_KEY_PREFIX + attrType;\n            var keyValue = element.getAttribute(keyAttr);\n            if (!keyValue) {\n                continue;\n            }\n            var preview = extractSourcePreview(element, attrType, keyValue);\n            if (!preview) {\n                preview = extractValue(element, attrType);\n            }\n            attrs.push({\n                type: attrType,\n                key: keyValue,\n                preview: preview\n            });\n        }\n        return attrs;\n    }\n\n    function extractValue(element, attrType) {\n        var value = '';\n        if (attrType === 'content') {\n            value = (element.innerText || element.textContent || '').trim();\n        } else {\n            value = (element.getAttribute(attrType) || '').trim();\n        }\n        return value;\n    }\n\n    function extractSourcePreview(element, attrType, keyValue) {\n        var attrName = 'data-xlate-original-' + attrType;\n        var value = '';\n        if (element && element.hasAttribute(attrName)) {\n            value = element.getAttribute(attrName) || '';\n        }\n        if (!value && keyValue && window.__XLATE__ && window.__XLATE__.sourceStrings) {\n            if (Object.prototype.hasOwnProperty.call(window.__XLATE__.sourceStrings, keyValue)) {\n                value = window.__XLATE__.sourceStrings[keyValue] || '';\n            }\n        }\n        if (!value) {\n            return '';\n        }\n        if (attrType === 'content') {\n            value = stripHtml(value);\n        }\n        value = value.trim();\n        return value;\n    }\n\n    function stripHtml(value) {\n        if (!value || value.indexOf('<') === -1) {\n            return value || '';\n        }\n        var div = document.createElement('div');\n        div.innerHTML = value;\n        return (div.textContent || div.innerText || '').trim();\n    }\n\n    function refreshOverlay() {\n        if (!STATE.currentElement) {\n            clearCurrent();\n            return;\n        }\n        var rect = STATE.currentElement.getBoundingClientRect();\n        var highlight = ensureNode('highlight');\n        highlight.style.left = rect.left + 'px';\n        highlight.style.top = rect.top + 'px';\n        highlight.style.width = Math.max(rect.width, 1) + 'px';\n        highlight.style.height = Math.max(rect.height, 1) + 'px';\n        highlight.classList.add('is-visible');\n        renderToolbar(rect);\n        renderCallout(rect);\n    }\n\n    function ensureNode(key) {\n        if (NODES[key]) {\n            return NODES[key];\n        }\n        var node;\n        if (key === 'highlight') {\n            node = document.createElement('div');\n            node.className = 'xlate-inspector-highlight';\n        } else if (key === 'toolbar') {\n            node = document.createElement('div');\n            node.className = 'xlate-inspector-toolbar';\n        } else if (key === 'callout') {\n            node = document.createElement('div');\n            node.className = 'xlate-inspector-callout';\n        }\n        document.body.appendChild(node);\n        NODES[key] = node;\n        return node;\n    }\n\n    function renderToolbar(rect) {\n        var toolbar = ensureNode('toolbar');\n        toolbar.innerHTML = '';\n        var attributes = document.createElement('div');\n        attributes.className = 'xlate-inspector-attributes';\n        STATE.attributes.forEach(function (attr) {\n            var btn = document.createElement('button');\n            btn.type = 'button';\n            btn.className = 'xlate-inspector-attr';\n            if (attr.type === STATE.currentAttribute) {\n                btn.classList.add('is-active');\n            }\n            btn.textContent = getAttributeLabel(attr.type);\n            btn.dataset.xlateAttr = attr.type;\n            btn.addEventListener('click', function (event) {\n                event.preventDefault();\n                STATE.currentAttribute = attr.type;\n                refreshOverlay();\n            });\n            attributes.appendChild(btn);\n        });\n        toolbar.appendChild(attributes);\n\n        var meta = document.createElement('div');\n        meta.className = 'xlate-inspector-meta';\n        var current = getCurrentAttribute();\n        var keyLabel = document.createElement('span');\n        keyLabel.className = 'xlate-inspector-key';\n        keyLabel.textContent = current ? current.key : STATE.config.strings.noKey || '';\n        meta.appendChild(keyLabel);\n\n        var copyBtn = document.createElement('button');\n        copyBtn.type = 'button';\n        copyBtn.className = 'xlate-inspector-action';\n        copyBtn.textContent = STATE.config.strings.copyKey || 'Copy key';\n        copyBtn.addEventListener('click', function (event) {\n            event.preventDefault();\n            if (current && current.key) {\n                copyToClipboard(current.key);\n            }\n        });\n        meta.appendChild(copyBtn);\n\n        var manageLink = document.createElement('a');\n        manageLink.className = 'xlate-inspector-action';\n        manageLink.textContent = STATE.config.strings.openManage || 'Open manage UI';\n        manageLink.href = buildManageUrl(current ? current.key : '');\n        manageLink.target = '_blank';\n        manageLink.rel = 'noopener noreferrer';\n        meta.appendChild(manageLink);\n        toolbar.appendChild(meta);\n\n        toolbar.classList.add('is-visible');\n        var top = rect.top - toolbar.offsetHeight - 12;\n        if (top < 8) {\n            top = rect.bottom + 12;\n        }\n        var left = rect.left;\n        var maxLeft = window.innerWidth - toolbar.offsetWidth - 12;\n        if (left > maxLeft) {\n            left = Math.max(maxLeft, 8);\n        }\n        if (left < 8) {\n            left = 8;\n        }\n        toolbar.style.left = left + 'px';\n        toolbar.style.top = top + 'px';\n    }\n\n    function renderCallout(rect) {\n        var callout = ensureNode('callout');\n        callout.innerHTML = '';\n        var current = getCurrentAttribute();\n        if (!current) {\n            callout.classList.remove('is-visible');\n            return;\n        }\n        var label = document.createElement('div');\n        label.className = 'xlate-inspector-callout-label';\n        label.textContent = getAttributeLabel(current.type);\n        callout.appendChild(label);\n        var text = document.createElement('div');\n        text.className = 'xlate-inspector-callout-text';\n        var preview = current.preview || STATE.config.strings.emptyValue || 'No value captured';\n        if (!current.preview) {\n            text.classList.add('xlate-inspector-empty');\n        }\n        text.textContent = preview;\n        callout.appendChild(text);\n        callout.classList.add('is-visible');\n        var top = rect.bottom + 12;\n        var left = rect.left;\n        var maxLeft = window.innerWidth - callout.offsetWidth - 12;\n        if (left > maxLeft) {\n            left = Math.max(maxLeft, 8);\n        }\n        if (left < 8) {\n            left = 8;\n        }\n        callout.style.left = left + 'px';\n        callout.style.top = top + 'px';\n    }\n\n    function getCurrentAttribute() {\n        for (var i = 0; i < STATE.attributes.length; i++) {\n            if (STATE.attributes[i].type === STATE.currentAttribute) {\n                return STATE.attributes[i];\n            }\n        }\n        return STATE.attributes[0] || null;\n    }\n\n    function getAttributeLabel(type) {\n        if (!STATE.config.strings) {\n            return type;\n        }\n        if (type === 'content') {\n            return STATE.config.strings.attributeContent || 'Text';\n        }\n        if (type === 'placeholder') {\n            return STATE.config.strings.attributePlaceholder || 'Placeholder';\n        }\n        if (type === 'title') {\n            return STATE.config.strings.attributeTitle || 'Title';\n        }\n        if (type === 'alt') {\n            return STATE.config.strings.attributeAlt || 'Alt text';\n        }\n        if (type === 'aria-label') {\n            return STATE.config.strings.attributeAria || 'Aria label';\n        }\n        return type;\n    }\n\n    function buildManageUrl(key) {\n        var base = STATE.config.manageUrl || '/local/xlate/manage.php';\n        var resolved;\n        try {\n            resolved = new URL(base, window.location.origin);\n        } catch (e) {\n            resolved = document.createElement('a');\n            resolved.href = base;\n            return resolved.href;\n        }\n        if (STATE.config.courseid) {\n            resolved.searchParams.set('courseid', STATE.config.courseid);\n        }\n        if (key) {\n            resolved.searchParams.set('search', key);\n        }\n        return resolved.toString();\n    }\n\n    function copyToClipboard(value) {\n        if (!value) {\n            return;\n        }\n        if (navigator.clipboard && navigator.clipboard.writeText) {\n            navigator.clipboard.writeText(value).then(function () {\n                showToast(STATE.config.strings.copied || 'Key copied');\n            }).catch(function () {\n                fallbackCopy(value);\n            });\n            return;\n        }\n        fallbackCopy(value);\n    }\n\n    function fallbackCopy(value) {\n        var temp = document.createElement('textarea');\n        temp.value = value;\n        temp.setAttribute('readonly', 'readonly');\n        temp.style.position = 'absolute';\n        temp.style.left = '-9999px';\n        document.body.appendChild(temp);\n        temp.select();\n        try {\n            document.execCommand('copy');\n            showToast(STATE.config.strings.copied || 'Key copied');\n        } catch (e) {\n            console.warn('[local_xlate] Unable to copy key', e); // eslint-disable-line no-console\n        }\n        document.body.removeChild(temp);\n    }\n\n    function showToast(message) {\n        var toast = document.querySelector('.xlate-inspector-toast');\n        if (!toast) {\n            toast = document.createElement('div');\n            toast.className = 'xlate-inspector-toast';\n            document.body.appendChild(toast);\n        }\n        toast.textContent = message;\n        toast.classList.add('is-visible');\n        window.clearTimeout(showToast.timeout);\n        showToast.timeout = window.setTimeout(function () {\n            toast.classList.remove('is-visible');\n        }, 2000);\n    }\n\n    function clearCurrent() {\n        STATE.currentElement = null;\n        STATE.attributes = [];\n        STATE.currentAttribute = null;\n        hideNode('highlight');\n        hideNode('toolbar');\n        hideNode('callout');\n    }\n\n    function hideNode(key) {\n        var node = NODES[key];\n        if (!node) {\n            return;\n        }\n        node.classList.remove('is-visible');\n    }\n\n    function registerToggle(button, options) {\n        if (!button) {\n            return;\n        }\n        STATE.hasExternalToggle = true;\n        if (NODES.toggle && NODES.toggle !== button) {\n            if (NODES.toggle.parentNode) {\n                NODES.toggle.parentNode.removeChild(NODES.toggle);\n            }\n            detachToggleButton(NODES.toggle);\n        }\n        NODES.toggle = button;\n        button.setAttribute('data-xlate-inspector-toggle', 'true');\n        if (options && typeof options.render === 'function') {\n            STATE.toggleRenderer = options.render;\n        } else {\n            STATE.toggleRenderer = null;\n        }\n        attachToggleButton(button);\n        updateToggleVisuals();\n    }\n\n    return {\n        init: init,\n        registerToggle: registerToggle\n    };\n});\n"],"names":["define","ATTRIBUTE_TYPES","SELECTOR","map","attr","join","STATE","config","enabled","manageUrl","courseid","strings","inlineToggle","active","currentElement","currentAttribute","attributes","ready","hasExternalToggle","toggleRenderer","NODES","toggle","highlight","toolbar","callout","merge","base","overrides","key","result","Object","prototype","hasOwnProperty","call","Array","isArray","val","attachToggleButton","button","addEventListener","handleToggleClick","event","preventDefault","deactivateInspector","document","handlePointerMove","handlePointerLeave","window","handleViewportChange","handleKeydown","documentElement","classList","add","updateToggleVisuals","showToast","toggleActive","activateInspector","removeEventListener","remove","clearCurrent","setAttribute","disabled","activeText","inactiveText","toggleInactive","textContent","isOverlayNode","target","candidate","closest","element","attrs","i","length","attrType","keyAttr","keyValue","getAttribute","preview","extractSourcePreview","extractValue","push","type","collectAttributes","attributeExists","refreshOverlay","setCurrentElement","clientX","clientY","rect","getBoundingClientRect","x","y","left","right","top","bottom","isWithinStickyZone","relatedTarget","node","innerText","trim","attrName","value","hasAttribute","__XLATE__","sourceStrings","indexOf","div","createElement","innerHTML","stripHtml","ensureNode","style","width","Math","max","height","className","forEach","btn","getAttributeLabel","dataset","xlateAttr","appendChild","meta","current","getCurrentAttribute","keyLabel","noKey","copyBtn","copyKey","navigator","clipboard","writeText","then","copied","catch","fallbackCopy","copyToClipboard","manageLink","openManage","href","resolved","URL","location","origin","e","searchParams","set","toString","buildManageUrl","rel","offsetHeight","maxLeft","innerWidth","offsetWidth","renderToolbar","label","text","emptyValue","renderCallout","body","attributeContent","attributePlaceholder","attributeTitle","attributeAlt","attributeAria","temp","position","select","execCommand","console","warn","removeChild","message","toast","querySelector","clearTimeout","timeout","setTimeout","hideNode","init","userConfig","fn","head","injectStyles","toggleLabel","title","toggleHint","buildToggle","readyState","registerToggle","options","parentNode","detachToggleButton","render"],"mappings":"AAGAA,0BAAO,IAAI,eAEHC,gBAAkB,CAAC,UAAW,cAAe,QAAS,MAAO,cAC7DC,SAAWD,gBAAgBE,KAAI,SAAUC,YAClC,mBAAwBA,KAAO,OACvCC,KAAK,KAEJC,MAAQ,CACRC,OAAQ,CACJC,SAAS,EACTC,UAAW,GACXC,SAAU,EACVC,QAAS,GACTC,cAAc,GAElBC,QAAQ,EACRC,eAAgB,KAChBC,iBAAkB,KAClBC,WAAY,GACZC,OAAO,EACPC,mBAAmB,EACnBC,eAAgB,MAEhBC,MAAQ,CACRC,OAAQ,KACRC,UAAW,KACXC,QAAS,KACTC,QAAS,eA6BJC,MAAMC,KAAMC,eAEbC,IADAC,OAAS,OAERD,OAAOF,KACJI,OAAOC,UAAUC,eAAeC,KAAKP,KAAME,OAClB,iBAAdF,KAAKE,MAAmC,OAAdF,KAAKE,MAAkBM,MAAMC,QAAQT,KAAKE,MAG3EC,OAAOD,KAAOF,KAAKE,KAFnBC,OAAOD,KAAOH,MAAMC,KAAKE,KAAM,SAMtCA,OAAOD,aACHG,OAAOC,UAAUC,eAAeC,KAAKN,UAAWC,UAGjDQ,IAAMT,UAAUC,KAChBQ,KAAsB,iBAARA,MAAqBF,MAAMC,QAAQC,KACjDP,OAAOD,KAAOH,MAAMI,OAAOD,MAAQ,GAAIQ,KAEvCP,OAAOD,KAAOQ,WAGfP,gBAyKFQ,mBAAmBC,QACnBA,QAGLA,OAAOC,iBAAiB,QAASC,4BAU5BA,kBAAkBC,OACvBA,MAAMC,iBACDpC,MAAMW,OAAUX,MAAMC,OAAOC,UAG9BF,MAAMO,OACN8B,oCAOArC,MAAMO,cAGVP,MAAMO,QAAS,EACf+B,SAASL,iBAAiB,cAAeM,mBAAmB,GAC5DD,SAASL,iBAAiB,eAAgBO,oBAAoB,GAC9DC,OAAOR,iBAAiB,SAAUS,sBAAsB,GACxDD,OAAOR,iBAAiB,SAAUS,sBAAsB,GACxDJ,SAASL,iBAAiB,UAAWU,eAAe,GACpDL,SAASM,gBAAgBC,UAAUC,IAAI,0BACvCC,sBACAC,UAAUhD,MAAMC,OAAOI,QAAQ4C,cAAgB,qBAhB3CC,aAmBCb,sBACArC,MAAMO,SAGXP,MAAMO,QAAS,EACf+B,SAASa,oBAAoB,cAAeZ,mBAAmB,GAC/DD,SAASa,oBAAoB,eAAgBX,oBAAoB,GACjEC,OAAOU,oBAAoB,SAAUT,sBAAsB,GAC3DD,OAAOU,oBAAoB,SAAUT,sBAAsB,GAC3DJ,SAASa,oBAAoB,UAAWR,eAAe,GACvDL,SAASM,gBAAgBC,UAAUO,OAAO,0BAC1CL,sBACAM,yBAGKN,yBACAjC,MAAMC,YAGPiB,OAASlB,MAAMC,UACff,MAAMO,QACNyB,OAAOa,UAAUC,IAAI,aACrBd,OAAOsB,aAAa,eAAgB,UAEpCtB,OAAOa,UAAUO,OAAO,aACxBpB,OAAOsB,aAAa,eAAgB,UAEpCtB,OAAOa,YACF7C,MAAMW,MAGPqB,OAAOa,UAAUO,OAAO,eAFxBpB,OAAOa,UAAUC,IAAI,qBAKE,IAApBd,OAAOuB,WACdvB,OAAOuB,UAAYvD,MAAMW,OAE7BqB,OAAOsB,aAAa,gBAAiBtD,MAAMW,MAAQ,QAAU,QACzDX,MAAMa,eACNb,MAAMa,eAAeb,MAAMO,YACxB,KACCiD,WAAaxD,MAAMC,OAAOI,QAAQ4C,cAAgB,oBAClDQ,aAAezD,MAAMC,OAAOI,QAAQqD,gBAAkB,mBAC1D1B,OAAO2B,YAAc3D,MAAMO,OAASiD,WAAaC,wBAIhDlB,kBAAkBJ,UAClBnC,MAAMO,SAGPqD,cAAczB,MAAM0B,aAGpBC,UAAY3B,MAAM0B,OAAOE,QAAU5B,MAAM0B,OAAOE,QAAQnE,UAAY,QACnEkE,UAOD9D,MAAMQ,iBAAmBsD,oBAsENE,YACvBhE,MAAMQ,eAAiBwD,QACvBhE,MAAMU,oBAuBiBsD,iBACnBC,MAAQ,GACHC,EAAI,EAAGA,EAAIvE,gBAAgBwE,OAAQD,IAAK,KACzCE,SAAWzE,gBAAgBuE,GAC3BG,QAjcU,kBAickBD,SAC5BE,SAAWN,QAAQO,aAAaF,YAC/BC,cAGDE,QAAUC,qBAAqBT,QAASI,SAAUE,UACjDE,UACDA,QAAUE,aAAaV,QAASI,WAEpCH,MAAMU,KAAK,CACPC,KAAMR,SACN9C,IAAKgD,SACLE,QAASA,kBAGVP,MA1CYY,CAAkBb,UAChChE,MAAMU,WAAWyD,mBAClBd,eAGCrD,MAAMS,mBACPT,MAAMS,iBAAmBT,MAAMU,WAAW,GAAGkE,gBAQ5BA,UAChB,IAAIV,EAAI,EAAGA,EAAIlE,MAAMU,WAAWyD,OAAQD,OACrClE,MAAMU,WAAWwD,GAAGU,OAASA,YACtB,SAGR,GAZFE,CAAgB9E,MAAMS,oBACvBT,MAAMS,iBAAmBT,MAAMU,WAAW,GAAGkE,MAEjDG,iBAhFAC,CAAkBlB,4BAgDM3B,WACnBnC,MAAMQ,sBACA,KAEkB,iBAAlB2B,MAAM8C,SAAiD,iBAAlB9C,MAAM+C,eAC3C,MAEPC,KAAOnF,MAAMQ,eAAe4E,4BAC3BD,YACM,MAEPE,EAAIlD,MAAM8C,QACVK,EAAInD,MAAM+C,eACPG,GAAKF,KAAKI,KAzZA,IA0ZbF,GAAKF,KAAKK,MA1ZG,IA2ZbF,GAAKH,KAAKM,IA3ZG,IA4ZbH,GAAKH,KAAKO,OA5ZG,GAmVTC,CAAmBxD,cAGvBkB,0BASCb,mBAAmBL,OACnBnC,MAAMO,SAGPqD,cAAczB,MAAMyD,gBAGnBzD,MAAMyD,eACPvC,yBAICX,uBACA1C,MAAMO,QAAWP,MAAMQ,gBAG5BuE,0BAGKpC,cAAcR,OACdnC,MAAMO,SAGO,WAAd4B,MAAMb,KAAkC,QAAda,MAAMb,MAChCa,MAAMC,iBACNC,iCAICuB,cAAciC,cACdA,OAGDA,OAAS/E,MAAMG,SAAW4E,OAAS/E,MAAMI,WAGxC2E,KAAK9B,YAIN8B,KAAK9B,QAAQ,8BACb8B,KAAK9B,QAAQ,uCAsEZW,aAAaV,QAASI,gBAEV,YAAbA,UACSJ,QAAQ8B,WAAa9B,QAAQL,aAAe,IAAIoC,QAEhD/B,QAAQO,aAAaH,WAAa,IAAI2B,gBAK9CtB,qBAAqBT,QAASI,SAAUE,cACzC0B,SAAW,uBAAyB5B,SACpC6B,MAAQ,UACRjC,SAAWA,QAAQkC,aAAaF,YAChCC,MAAQjC,QAAQO,aAAayB,WAAa,KAEzCC,OAAS3B,UAAY7B,OAAO0D,WAAa1D,OAAO0D,UAAUC,eACvD5E,OAAOC,UAAUC,eAAeC,KAAKc,OAAO0D,UAAUC,cAAe9B,YACrE2B,MAAQxD,OAAO0D,UAAUC,cAAc9B,WAAa,IAGvD2B,OAGY,YAAb7B,WACA6B,eAMWA,WACVA,QAAiC,IAAxBA,MAAMI,QAAQ,YACjBJ,OAAS,OAEhBK,IAAMhE,SAASiE,cAAc,cACjCD,IAAIE,UAAYP,OACRK,IAAI3C,aAAe2C,IAAIR,WAAa,IAAIC,OAZpCU,CAAUR,QAEtBA,MAAQA,MAAMF,QALH,YAkBNhB,oBACA/E,MAAMQ,oBAIP2E,KAAOnF,MAAMQ,eAAe4E,wBAC5BpE,UAAY0F,WAAW,aAC3B1F,UAAU2F,MAAMpB,KAAOJ,KAAKI,KAAO,KACnCvE,UAAU2F,MAAMlB,IAAMN,KAAKM,IAAM,KACjCzE,UAAU2F,MAAMC,MAAQC,KAAKC,IAAI3B,KAAKyB,MAAO,GAAK,KAClD5F,UAAU2F,MAAMI,OAASF,KAAKC,IAAI3B,KAAK4B,OAAQ,GAAK,KACpD/F,UAAU6B,UAAUC,IAAI,uBAyBLqC,UACflE,QAAUyF,WAAW,WACzBzF,QAAQuF,UAAY,OAChB9F,WAAa4B,SAASiE,cAAc,OACxC7F,WAAWsG,UAAY,6BACvBhH,MAAMU,WAAWuG,SAAQ,SAAUnH,UAC3BoH,IAAM5E,SAASiE,cAAc,UACjCW,IAAItC,KAAO,SACXsC,IAAIF,UAAY,uBACZlH,KAAK8E,OAAS5E,MAAMS,kBACpByG,IAAIrE,UAAUC,IAAI,aAEtBoE,IAAIvD,YAAcwD,kBAAkBrH,KAAK8E,MACzCsC,IAAIE,QAAQC,UAAYvH,KAAK8E,KAC7BsC,IAAIjF,iBAAiB,SAAS,SAAUE,OACpCA,MAAMC,iBACNpC,MAAMS,iBAAmBX,KAAK8E,KAC9BG,oBAEJrE,WAAW4G,YAAYJ,QAE3BjG,QAAQqG,YAAY5G,gBAEhB6G,KAAOjF,SAASiE,cAAc,OAClCgB,KAAKP,UAAY,2BACbQ,QAAUC,sBACVC,SAAWpF,SAASiE,cAAc,QACtCmB,SAASV,UAAY,sBACrBU,SAAS/D,YAAc6D,QAAUA,QAAQlG,IAAMtB,MAAMC,OAAOI,QAAQsH,OAAS,GAC7EJ,KAAKD,YAAYI,cAEbE,QAAUtF,SAASiE,cAAc,UACrCqB,QAAQhD,KAAO,SACfgD,QAAQZ,UAAY,yBACpBY,QAAQjE,YAAc3D,MAAMC,OAAOI,QAAQwH,SAAW,WACtDD,QAAQ3F,iBAAiB,SAAS,SAAUE,OACxCA,MAAMC,iBACFoF,SAAWA,QAAQlG,cAoHN2E,WAChBA,gBAGD6B,UAAUC,WAAaD,UAAUC,UAAUC,sBAC3CF,UAAUC,UAAUC,UAAU/B,OAAOgC,MAAK,WACtCjF,UAAUhD,MAAMC,OAAOI,QAAQ6H,QAAU,iBAC1CC,OAAM,WACLC,aAAanC,UAIrBmC,aAAanC,OA/HLoC,CAAgBb,QAAQlG,QAGhCiG,KAAKD,YAAYM,aAEbU,WAAahG,SAASiE,cAAc,KACxC+B,WAAWtB,UAAY,yBACvBsB,WAAW3E,YAAc3D,MAAMC,OAAOI,QAAQkI,YAAc,iBAC5DD,WAAWE,cAwFSlH,SAEhBmH,SADArH,KAAOpB,MAAMC,OAAOE,WAAa,8BAGjCsI,SAAW,IAAIC,IAAItH,KAAMqB,OAAOkG,SAASC,QAC3C,MAAOC,UACLJ,SAAWnG,SAASiE,cAAc,MACzBiC,KAAOpH,KACTqH,SAASD,KAEhBxI,MAAMC,OAAOG,UACbqI,SAASK,aAAaC,IAAI,WAAY/I,MAAMC,OAAOG,UAEnDkB,KACAmH,SAASK,aAAaC,IAAI,SAAUzH,YAEjCmH,SAASO,WAxGEC,CAAezB,QAAUA,QAAQlG,IAAM,IACzDgH,WAAWzE,OAAS,SACpByE,WAAWY,IAAM,sBACjB3B,KAAKD,YAAYgB,YACjBrH,QAAQqG,YAAYC,MAEpBtG,QAAQ4B,UAAUC,IAAI,kBAClB2C,IAAMN,KAAKM,IAAMxE,QAAQkI,aAAe,GACxC1D,IAAM,IACNA,IAAMN,KAAKO,OAAS,QAEpBH,KAAOJ,KAAKI,KACZ6D,QAAU3G,OAAO4G,WAAapI,QAAQqI,YAAc,GACpD/D,KAAO6D,UACP7D,KAAOsB,KAAKC,IAAIsC,QAAS,IAEzB7D,KAAO,IACPA,KAAO,GAEXtE,QAAQ0F,MAAMpB,KAAOA,KAAO,KAC5BtE,QAAQ0F,MAAMlB,IAAMA,IAAM,KA1F1B8D,CAAcpE,eA6FKA,UACfjE,QAAUwF,WAAW,WACzBxF,QAAQsF,UAAY,OAChBgB,QAAUC,0BACTD,oBACDtG,QAAQ2B,UAAUO,OAAO,kBAGzBoG,MAAQlH,SAASiE,cAAc,OACnCiD,MAAMxC,UAAY,gCAClBwC,MAAM7F,YAAcwD,kBAAkBK,QAAQ5C,MAC9C1D,QAAQoG,YAAYkC,WAChBC,KAAOnH,SAASiE,cAAc,OAClCkD,KAAKzC,UAAY,mCACbxC,QAAUgD,QAAQhD,SAAWxE,MAAMC,OAAOI,QAAQqJ,YAAc,oBAC/DlC,QAAQhD,SACTiF,KAAK5G,UAAUC,IAAI,yBAEvB2G,KAAK9F,YAAca,QACnBtD,QAAQoG,YAAYmC,MACpBvI,QAAQ2B,UAAUC,IAAI,kBAClB2C,IAAMN,KAAKO,OAAS,GACpBH,KAAOJ,KAAKI,KACZ6D,QAAU3G,OAAO4G,WAAanI,QAAQoI,YAAc,GACpD/D,KAAO6D,UACP7D,KAAOsB,KAAKC,IAAIsC,QAAS,IAEzB7D,KAAO,IACPA,KAAO,GAEXrE,QAAQyF,MAAMpB,KAAOA,KAAO,KAC5BrE,QAAQyF,MAAMlB,IAAMA,IAAM,KA3H1BkE,CAAcxE,WAXV9B,wBAcCqD,WAAWpF,YACZR,MAAMQ,KACCR,MAAMQ,MAGL,cAARA,KACAuE,KAAOvD,SAASiE,cAAc,QACzBS,UAAY,4BACF,YAAR1F,KACPuE,KAAOvD,SAASiE,cAAc,QACzBS,UAAY,0BACF,YAAR1F,OACPuE,KAAOvD,SAASiE,cAAc,QACzBS,UAAY,2BAErB1E,SAASsH,KAAKtC,YAAYzB,MAC1B/E,MAAMQ,KAAOuE,KACNA,UAbHA,cAuHC4B,0BACA,IAAIvD,EAAI,EAAGA,EAAIlE,MAAMU,WAAWyD,OAAQD,OACrClE,MAAMU,WAAWwD,GAAGU,OAAS5E,MAAMS,wBAC5BT,MAAMU,WAAWwD,UAGzBlE,MAAMU,WAAW,IAAM,cAGzByG,kBAAkBvC,aAClB5E,MAAMC,OAAOI,QAGL,YAATuE,KACO5E,MAAMC,OAAOI,QAAQwJ,kBAAoB,OAEvC,gBAATjF,KACO5E,MAAMC,OAAOI,QAAQyJ,sBAAwB,cAE3C,UAATlF,KACO5E,MAAMC,OAAOI,QAAQ0J,gBAAkB,QAErC,QAATnF,KACO5E,MAAMC,OAAOI,QAAQ2J,cAAgB,WAEnC,eAATpF,KACO5E,MAAMC,OAAOI,QAAQ4J,eAAiB,aAE1CrF,KAjBIA,cAsDNwD,aAAanC,WACdiE,KAAO5H,SAASiE,cAAc,YAClC2D,KAAKjE,MAAQA,MACbiE,KAAK5G,aAAa,WAAY,YAC9B4G,KAAKvD,MAAMwD,SAAW,WACtBD,KAAKvD,MAAMpB,KAAO,UAClBjD,SAASsH,KAAKtC,YAAY4C,MAC1BA,KAAKE,aAED9H,SAAS+H,YAAY,QACrBrH,UAAUhD,MAAMC,OAAOI,QAAQ6H,QAAU,cAC3C,MAAOW,GACLyB,QAAQC,KAAK,mCAAoC1B,GAErDvG,SAASsH,KAAKY,YAAYN,eAGrBlH,UAAUyH,aACXC,MAAQpI,SAASqI,cAAc,0BAC9BD,SACDA,MAAQpI,SAASiE,cAAc,QACzBS,UAAY,wBAClB1E,SAASsH,KAAKtC,YAAYoD,QAE9BA,MAAM/G,YAAc8G,QACpBC,MAAM7H,UAAUC,IAAI,cACpBL,OAAOmI,aAAa5H,UAAU6H,SAC9B7H,UAAU6H,QAAUpI,OAAOqI,YAAW,WAClCJ,MAAM7H,UAAUO,OAAO,gBACxB,cAGEC,eACLrD,MAAMQ,eAAiB,KACvBR,MAAMU,WAAa,GACnBV,MAAMS,iBAAmB,KACzBsK,SAAS,aACTA,SAAS,WACTA,SAAS,oBAGJA,SAASzJ,SACVuE,KAAO/E,MAAMQ,KACZuE,MAGLA,KAAKhD,UAAUO,OAAO,oBAyBnB,CACH4H,cA1uBUC,gBARCC,GASW,oBAAXzI,QAA8C,oBAAbH,WAG5CtC,MAAMC,OAASkB,MAAMnB,MAAMC,OAAQgL,YAAc,IAC5CjL,MAAMC,OAAOC,UAbPgL,GAgBL,2BAqCF5I,SAASqI,cAAc,4CAGvBhE,MAAQrE,SAASiE,cAAc,SACnCI,MAAMrD,aAAa,mBAAoB,aACvCqD,MAAMhD,YAAc,m3EAsIpBrB,SAAS6I,KAAK7D,YAAYX,QA/KtByE,GACKpL,MAAMY,mBAAsBZ,MAAMC,OAAOK,6BAkL9CN,MAAMY,oBAAqBE,MAAMC,YAGjCiB,OAASM,SAASiE,cAAc,UACpCvE,OAAO4C,KAAO,SACd5C,OAAOgF,UAAY,yCACnBhF,OAAO2B,YAAc3D,MAAMC,OAAOI,QAAQqD,gBAAkB,mBAC5D1B,OAAOsB,aAAa,eAAgB,SACpCtB,OAAOsB,aAAa,aAActD,MAAMC,OAAOI,QAAQgL,aAAe,yBACtErJ,OAAOsJ,MAAQtL,MAAMC,OAAOI,QAAQkL,YAAc,GAClDvJ,OAAOsB,aAAa,8BAA+B,QACnDvB,mBAAmBC,QACnBhC,MAAMa,eAAiB,SAAUN,YACzBiD,WAAaxD,MAAMC,OAAOI,QAAQ4C,cAAgB,oBAClDQ,aAAezD,MAAMC,OAAOI,QAAQqD,gBAAkB,mBAC1D1B,OAAO2B,YAAcpD,OAASiD,WAAaC,cAE/C3C,MAAMC,OAASiB,OACfM,SAASsH,KAAKtC,YAAYtF,QAC1Be,uBApMQyI,GAEJxL,MAAMW,OAAQ,EACdoC,uBArBwB,YAAxBT,SAASmJ,WAIbP,KAHI5I,SAASL,iBAAiB,mBAAoBiJ,OAivBlDQ,wBAxBoB1J,OAAQ2J,SACvB3J,SAGLhC,MAAMY,mBAAoB,EACtBE,MAAMC,QAAUD,MAAMC,SAAWiB,SAC7BlB,MAAMC,OAAO6K,YACb9K,MAAMC,OAAO6K,WAAWpB,YAAY1J,MAAMC,iBAjgB1BiB,QACnBA,QAGLA,OAAOmB,oBAAoB,QAASjB,mBA+fhC2J,CAAmB/K,MAAMC,SAE7BD,MAAMC,OAASiB,OACfA,OAAOsB,aAAa,8BAA+B,QAC/CqI,SAAqC,mBAAnBA,QAAQG,OAC1B9L,MAAMa,eAAiB8K,QAAQG,OAE/B9L,MAAMa,eAAiB,KAE3BkB,mBAAmBC,QACnBe"}